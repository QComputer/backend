{"{\"assumptions\":{},\"sourceRoot\":\"/Users/ahmad/Documents/projects/zero-project/backend/tests/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/ahmad/Documents/projects/zero-project/backend\",\"filename\":\"/Users/ahmad/Documents/projects/zero-project/backend/tests/guest-functionality.test.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/ahmad/Documents/projects/zero-project/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-explicit-resource-management\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"BlockStatement\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$12\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$17\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.28.5:development":{"value":{"code":"\"use strict\";\n\nconst {\n  expect\n} = require('chai');\nconst request = require('supertest');\nconst app = require('../server');\nconst orderModel = require('../models/orderModel');\nconst cartModel = require('../models/cartModel');\nconst productModel = require('../models/productModel');\nconst catalogModel = require('../models/catalogModel');\ndescribe('Guest User Functionality', () => {\n  const testSessionId = 'test-guest-session-123';\n  let testProductId;\n  let testCatalogId;\n  before(async () => {\n    // Setup test data - create a test product and catalog\n    const product = new productModel({\n      name: 'Test Product',\n      description: 'Test product for guest functionality',\n      price: 10.99,\n      available: true,\n      stock: 100,\n      store: 'test-store-id',\n      category: 'test-category-id'\n    });\n    await product.save();\n    testProductId = product._id;\n    const catalog = new catalogModel({\n      name: 'Test Catalog',\n      store: 'test-store-id',\n      description: 'Test catalog for guest functionality',\n      isPublic: true,\n      isActive: true,\n      ownerId: 'test-store-id',\n      products: [{\n        product: testProductId,\n        addedAt: new Date()\n      }]\n    });\n    await catalog.save();\n    testCatalogId = catalog._id;\n\n    // Clean up any existing test data\n    await cartModel.deleteMany({\n      session: testSessionId\n    });\n    await orderModel.deleteMany({\n      guestSessionId: testSessionId\n    });\n  });\n  describe('Guest Cart Operations', () => {\n    it('should add items to guest cart', async () => {\n      const response = await request(app).post('/api/v1/cart/guest').set('x-session-id', testSessionId).send({\n        itemId: testProductId,\n        quantity: 2\n      });\n      expect(response.status).to.equal(200);\n      expect(response.body.success).to.be.true;\n    });\n    it('should get guest cart with standardized structure', async () => {\n      const response = await request(app).get('/api/v1/cart/guest').set('x-session-id', testSessionId);\n      expect(response.status).to.equal(200);\n      expect(response.body.success).to.be.true;\n      expect(response.body.data).to.be.an('array');\n      expect(response.body.isGuest).to.be.true;\n      if (response.body.data.length > 0) {\n        const cart = response.body.data[0];\n        expect(cart).to.have.property('items');\n        expect(cart.items[0]).to.have.nested.property('product._id');\n        expect(cart.items[0]).to.have.nested.property('product.name');\n        expect(cart.items[0].product.name).to.equal('Test Product');\n      }\n    });\n    it('should clear guest cart', async () => {\n      // First add an item to ensure there's something to clear\n      await request(app).post('/api/v1/cart/guest').set('x-session-id', testSessionId).send({\n        itemId: testProductId,\n        quantity: 1\n      });\n\n      // Now clear the cart\n      const response = await request(app).post('/api/v1/cart/guest/clear').set('x-session-id', testSessionId);\n      expect(response.status).to.equal(200);\n      expect(response.body.success).to.be.true;\n      expect(response.body.isGuest).to.be.true;\n\n      // Verify cart is empty\n      const cartResponse = await request(app).get('/api/v1/cart/guest').set('x-session-id', testSessionId);\n      expect(cartResponse.body.data).to.be.an('array');\n      expect(cartResponse.body.data.length).to.equal(0);\n    });\n  });\n  describe('Guest Order Operations', () => {\n    let testOrderId;\n    it('should place guest order', async () => {\n      // First add item to cart\n      await request(app).post('/api/v1/cart/guest').set('x-session-id', testSessionId).send({\n        itemId: testProductId,\n        quantity: 1\n      });\n\n      // Then place order\n      const response = await request(app).post('/api/v1/orders/place-guest-catalog').set('x-session-id', testSessionId).send({\n        catalogId: testCatalogId,\n        items: [{\n          productId: testProductId,\n          quantity: 1,\n          name: 'Test Product',\n          price: 10.99\n        }],\n        phone: '1234567890',\n        deliveryAddress: 'Test Address',\n        isTakeout: false,\n        deliveryFee: 2.99\n      });\n      expect(response.status).to.equal(200);\n      expect(response.body.success).to.be.true;\n      expect(response.body).to.have.property('orderId');\n      expect(response.body.isGuest).to.be.true;\n      testOrderId = response.body.orderId;\n    });\n    it('should get guest orders', async () => {\n      const response = await request(app).post('/api/v1/orders/guest-orders').set('x-session-id', testSessionId).send({});\n      expect(response.status).to.equal(200);\n      expect(response.body.success).to.be.true;\n      expect(response.body.data).to.be.an('array');\n      expect(response.body.data.length).to.be.at.least(1);\n    });\n    it('should cancel guest order', async () => {\n      const response = await request(app).post('/api/v1/orders/cancel-guest').set('x-session-id', testSessionId).send({\n        orderId: testOrderId\n      });\n      expect(response.status).to.equal(200);\n      expect(response.body.success).to.be.true;\n      expect(response.body.isGuest).to.be.true;\n    });\n    it('should get guest order progress', async () => {\n      // Create a new order for progress testing\n      const placeResponse = await request(app).post('/api/v1/orders/place-guest-catalog').set('x-session-id', testSessionId).send({\n        catalogId: testCatalogId,\n        items: [{\n          productId: testProductId,\n          quantity: 1,\n          name: 'Test Product',\n          price: 10.99\n        }],\n        phone: '1234567890',\n        deliveryAddress: 'Test Address',\n        isTakeout: false,\n        deliveryFee: 2.99\n      });\n      const newOrderId = placeResponse.body.orderId;\n      const progressResponse = await request(app).get(`/api/v1/orders/guest-progress/${newOrderId}`).set('x-session-id', testSessionId);\n      expect(progressResponse.status).to.equal(200);\n      expect(progressResponse.body.success).to.be.true;\n      expect(progressResponse.body.data).to.have.property('progressPrepare');\n      expect(progressResponse.body.data).to.have.property('minutesLeftPrepare');\n      expect(progressResponse.body.isGuest).to.be.true;\n    });\n  });\n  after(async () => {\n    // Cleanup\n    await cartModel.deleteMany({\n      session: testSessionId\n    });\n    await orderModel.deleteMany({\n      guestSessionId: testSessionId\n    });\n    await productModel.deleteMany({\n      name: 'Test Product'\n    });\n    await catalogModel.deleteMany({\n      name: 'Test Catalog'\n    });\n  });\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHBlY3QiLCJyZXF1aXJlIiwicmVxdWVzdCIsImFwcCIsIm9yZGVyTW9kZWwiLCJjYXJ0TW9kZWwiLCJwcm9kdWN0TW9kZWwiLCJjYXRhbG9nTW9kZWwiLCJkZXNjcmliZSIsInRlc3RTZXNzaW9uSWQiLCJ0ZXN0UHJvZHVjdElkIiwidGVzdENhdGFsb2dJZCIsImJlZm9yZSIsInByb2R1Y3QiLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJwcmljZSIsImF2YWlsYWJsZSIsInN0b2NrIiwic3RvcmUiLCJjYXRlZ29yeSIsInNhdmUiLCJfaWQiLCJjYXRhbG9nIiwiaXNQdWJsaWMiLCJpc0FjdGl2ZSIsIm93bmVySWQiLCJwcm9kdWN0cyIsImFkZGVkQXQiLCJEYXRlIiwiZGVsZXRlTWFueSIsInNlc3Npb24iLCJndWVzdFNlc3Npb25JZCIsIml0IiwicmVzcG9uc2UiLCJwb3N0Iiwic2V0Iiwic2VuZCIsIml0ZW1JZCIsInF1YW50aXR5Iiwic3RhdHVzIiwidG8iLCJlcXVhbCIsImJvZHkiLCJzdWNjZXNzIiwiYmUiLCJ0cnVlIiwiZ2V0IiwiZGF0YSIsImFuIiwiaXNHdWVzdCIsImxlbmd0aCIsImNhcnQiLCJoYXZlIiwicHJvcGVydHkiLCJpdGVtcyIsIm5lc3RlZCIsImNhcnRSZXNwb25zZSIsInRlc3RPcmRlcklkIiwiY2F0YWxvZ0lkIiwicHJvZHVjdElkIiwicGhvbmUiLCJkZWxpdmVyeUFkZHJlc3MiLCJpc1Rha2VvdXQiLCJkZWxpdmVyeUZlZSIsIm9yZGVySWQiLCJhdCIsImxlYXN0IiwicGxhY2VSZXNwb25zZSIsIm5ld09yZGVySWQiLCJwcm9ncmVzc1Jlc3BvbnNlIiwiYWZ0ZXIiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9haG1hZC9Eb2N1bWVudHMvcHJvamVjdHMvemVyby1wcm9qZWN0L2JhY2tlbmQvdGVzdHMvIiwic291cmNlcyI6WyJndWVzdC1mdW5jdGlvbmFsaXR5LnRlc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBleHBlY3QgfSA9IHJlcXVpcmUoJ2NoYWknKTtcbmNvbnN0IHJlcXVlc3QgPSByZXF1aXJlKCdzdXBlcnRlc3QnKTtcbmNvbnN0IGFwcCA9IHJlcXVpcmUoJy4uL3NlcnZlcicpO1xuY29uc3Qgb3JkZXJNb2RlbCA9IHJlcXVpcmUoJy4uL21vZGVscy9vcmRlck1vZGVsJyk7XG5jb25zdCBjYXJ0TW9kZWwgPSByZXF1aXJlKCcuLi9tb2RlbHMvY2FydE1vZGVsJyk7XG5jb25zdCBwcm9kdWN0TW9kZWwgPSByZXF1aXJlKCcuLi9tb2RlbHMvcHJvZHVjdE1vZGVsJyk7XG5jb25zdCBjYXRhbG9nTW9kZWwgPSByZXF1aXJlKCcuLi9tb2RlbHMvY2F0YWxvZ01vZGVsJyk7XG5cbmRlc2NyaWJlKCdHdWVzdCBVc2VyIEZ1bmN0aW9uYWxpdHknLCAoKSA9PiB7XG4gIGNvbnN0IHRlc3RTZXNzaW9uSWQgPSAndGVzdC1ndWVzdC1zZXNzaW9uLTEyMyc7XG4gIGxldCB0ZXN0UHJvZHVjdElkO1xuICBsZXQgdGVzdENhdGFsb2dJZDtcblxuICBiZWZvcmUoYXN5bmMgKCkgPT4ge1xuICAgIC8vIFNldHVwIHRlc3QgZGF0YSAtIGNyZWF0ZSBhIHRlc3QgcHJvZHVjdCBhbmQgY2F0YWxvZ1xuICAgIGNvbnN0IHByb2R1Y3QgPSBuZXcgcHJvZHVjdE1vZGVsKHtcbiAgICAgIG5hbWU6ICdUZXN0IFByb2R1Y3QnLFxuICAgICAgZGVzY3JpcHRpb246ICdUZXN0IHByb2R1Y3QgZm9yIGd1ZXN0IGZ1bmN0aW9uYWxpdHknLFxuICAgICAgcHJpY2U6IDEwLjk5LFxuICAgICAgYXZhaWxhYmxlOiB0cnVlLFxuICAgICAgc3RvY2s6IDEwMCxcbiAgICAgIHN0b3JlOiAndGVzdC1zdG9yZS1pZCcsXG4gICAgICBjYXRlZ29yeTogJ3Rlc3QtY2F0ZWdvcnktaWQnXG4gICAgfSk7XG4gICAgYXdhaXQgcHJvZHVjdC5zYXZlKCk7XG4gICAgdGVzdFByb2R1Y3RJZCA9IHByb2R1Y3QuX2lkO1xuXG4gICAgY29uc3QgY2F0YWxvZyA9IG5ldyBjYXRhbG9nTW9kZWwoe1xuICAgICAgbmFtZTogJ1Rlc3QgQ2F0YWxvZycsXG4gICAgICBzdG9yZTogJ3Rlc3Qtc3RvcmUtaWQnLFxuICAgICAgZGVzY3JpcHRpb246ICdUZXN0IGNhdGFsb2cgZm9yIGd1ZXN0IGZ1bmN0aW9uYWxpdHknLFxuICAgICAgaXNQdWJsaWM6IHRydWUsXG4gICAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgICAgIG93bmVySWQ6ICd0ZXN0LXN0b3JlLWlkJyxcbiAgICAgIHByb2R1Y3RzOiBbe1xuICAgICAgICBwcm9kdWN0OiB0ZXN0UHJvZHVjdElkLFxuICAgICAgICBhZGRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICB9XVxuICAgIH0pO1xuICAgIGF3YWl0IGNhdGFsb2cuc2F2ZSgpO1xuICAgIHRlc3RDYXRhbG9nSWQgPSBjYXRhbG9nLl9pZDtcblxuICAgIC8vIENsZWFuIHVwIGFueSBleGlzdGluZyB0ZXN0IGRhdGFcbiAgICBhd2FpdCBjYXJ0TW9kZWwuZGVsZXRlTWFueSh7IHNlc3Npb246IHRlc3RTZXNzaW9uSWQgfSk7XG4gICAgYXdhaXQgb3JkZXJNb2RlbC5kZWxldGVNYW55KHsgZ3Vlc3RTZXNzaW9uSWQ6IHRlc3RTZXNzaW9uSWQgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdHdWVzdCBDYXJ0IE9wZXJhdGlvbnMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBhZGQgaXRlbXMgdG8gZ3Vlc3QgY2FydCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KCcvYXBpL3YxL2NhcnQvZ3Vlc3QnKVxuICAgICAgICAuc2V0KCd4LXNlc3Npb24taWQnLCB0ZXN0U2Vzc2lvbklkKVxuICAgICAgICAuc2VuZCh7XG4gICAgICAgICAgaXRlbUlkOiB0ZXN0UHJvZHVjdElkLFxuICAgICAgICAgIHF1YW50aXR5OiAyXG4gICAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50by5lcXVhbCgyMDApO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuc3VjY2VzcykudG8uYmUudHJ1ZTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2V0IGd1ZXN0IGNhcnQgd2l0aCBzdGFuZGFyZGl6ZWQgc3RydWN0dXJlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL2FwaS92MS9jYXJ0L2d1ZXN0JylcbiAgICAgICAgLnNldCgneC1zZXNzaW9uLWlkJywgdGVzdFNlc3Npb25JZCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvLmVxdWFsKDIwMCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5zdWNjZXNzKS50by5iZS50cnVlO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZGF0YSkudG8uYmUuYW4oJ2FycmF5Jyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5pc0d1ZXN0KS50by5iZS50cnVlO1xuXG4gICAgICBpZiAocmVzcG9uc2UuYm9keS5kYXRhLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgY2FydCA9IHJlc3BvbnNlLmJvZHkuZGF0YVswXTtcbiAgICAgICAgZXhwZWN0KGNhcnQpLnRvLmhhdmUucHJvcGVydHkoJ2l0ZW1zJyk7XG4gICAgICAgIGV4cGVjdChjYXJ0Lml0ZW1zWzBdKS50by5oYXZlLm5lc3RlZC5wcm9wZXJ0eSgncHJvZHVjdC5faWQnKTtcbiAgICAgICAgZXhwZWN0KGNhcnQuaXRlbXNbMF0pLnRvLmhhdmUubmVzdGVkLnByb3BlcnR5KCdwcm9kdWN0Lm5hbWUnKTtcbiAgICAgICAgZXhwZWN0KGNhcnQuaXRlbXNbMF0ucHJvZHVjdC5uYW1lKS50by5lcXVhbCgnVGVzdCBQcm9kdWN0Jyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNsZWFyIGd1ZXN0IGNhcnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBGaXJzdCBhZGQgYW4gaXRlbSB0byBlbnN1cmUgdGhlcmUncyBzb21ldGhpbmcgdG8gY2xlYXJcbiAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS92MS9jYXJ0L2d1ZXN0JylcbiAgICAgICAgLnNldCgneC1zZXNzaW9uLWlkJywgdGVzdFNlc3Npb25JZClcbiAgICAgICAgLnNlbmQoe1xuICAgICAgICAgIGl0ZW1JZDogdGVzdFByb2R1Y3RJZCxcbiAgICAgICAgICBxdWFudGl0eTogMVxuICAgICAgICB9KTtcblxuICAgICAgLy8gTm93IGNsZWFyIHRoZSBjYXJ0XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS92MS9jYXJ0L2d1ZXN0L2NsZWFyJylcbiAgICAgICAgLnNldCgneC1zZXNzaW9uLWlkJywgdGVzdFNlc3Npb25JZCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvLmVxdWFsKDIwMCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5zdWNjZXNzKS50by5iZS50cnVlO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuaXNHdWVzdCkudG8uYmUudHJ1ZTtcblxuICAgICAgLy8gVmVyaWZ5IGNhcnQgaXMgZW1wdHlcbiAgICAgIGNvbnN0IGNhcnRSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvYXBpL3YxL2NhcnQvZ3Vlc3QnKVxuICAgICAgICAuc2V0KCd4LXNlc3Npb24taWQnLCB0ZXN0U2Vzc2lvbklkKTtcblxuICAgICAgZXhwZWN0KGNhcnRSZXNwb25zZS5ib2R5LmRhdGEpLnRvLmJlLmFuKCdhcnJheScpO1xuICAgICAgZXhwZWN0KGNhcnRSZXNwb25zZS5ib2R5LmRhdGEubGVuZ3RoKS50by5lcXVhbCgwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0d1ZXN0IE9yZGVyIE9wZXJhdGlvbnMnLCAoKSA9PiB7XG4gICAgbGV0IHRlc3RPcmRlcklkO1xuXG4gICAgaXQoJ3Nob3VsZCBwbGFjZSBndWVzdCBvcmRlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEZpcnN0IGFkZCBpdGVtIHRvIGNhcnRcbiAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS92MS9jYXJ0L2d1ZXN0JylcbiAgICAgICAgLnNldCgneC1zZXNzaW9uLWlkJywgdGVzdFNlc3Npb25JZClcbiAgICAgICAgLnNlbmQoe1xuICAgICAgICAgIGl0ZW1JZDogdGVzdFByb2R1Y3RJZCxcbiAgICAgICAgICBxdWFudGl0eTogMVxuICAgICAgICB9KTtcblxuICAgICAgLy8gVGhlbiBwbGFjZSBvcmRlclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoJy9hcGkvdjEvb3JkZXJzL3BsYWNlLWd1ZXN0LWNhdGFsb2cnKVxuICAgICAgICAuc2V0KCd4LXNlc3Npb24taWQnLCB0ZXN0U2Vzc2lvbklkKVxuICAgICAgICAuc2VuZCh7XG4gICAgICAgICAgY2F0YWxvZ0lkOiB0ZXN0Q2F0YWxvZ0lkLFxuICAgICAgICAgIGl0ZW1zOiBbe1xuICAgICAgICAgICAgcHJvZHVjdElkOiB0ZXN0UHJvZHVjdElkLFxuICAgICAgICAgICAgcXVhbnRpdHk6IDEsXG4gICAgICAgICAgICBuYW1lOiAnVGVzdCBQcm9kdWN0JyxcbiAgICAgICAgICAgIHByaWNlOiAxMC45OVxuICAgICAgICAgIH1dLFxuICAgICAgICAgIHBob25lOiAnMTIzNDU2Nzg5MCcsXG4gICAgICAgICAgZGVsaXZlcnlBZGRyZXNzOiAnVGVzdCBBZGRyZXNzJyxcbiAgICAgICAgICBpc1Rha2VvdXQ6IGZhbHNlLFxuICAgICAgICAgIGRlbGl2ZXJ5RmVlOiAyLjk5XG4gICAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50by5lcXVhbCgyMDApO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuc3VjY2VzcykudG8uYmUudHJ1ZTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50by5oYXZlLnByb3BlcnR5KCdvcmRlcklkJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5pc0d1ZXN0KS50by5iZS50cnVlO1xuICAgICAgdGVzdE9yZGVySWQgPSByZXNwb25zZS5ib2R5Lm9yZGVySWQ7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGdldCBndWVzdCBvcmRlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS92MS9vcmRlcnMvZ3Vlc3Qtb3JkZXJzJylcbiAgICAgICAgLnNldCgneC1zZXNzaW9uLWlkJywgdGVzdFNlc3Npb25JZClcbiAgICAgICAgLnNlbmQoe30pO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50by5lcXVhbCgyMDApO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuc3VjY2VzcykudG8uYmUudHJ1ZTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGEpLnRvLmJlLmFuKCdhcnJheScpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZGF0YS5sZW5ndGgpLnRvLmJlLmF0LmxlYXN0KDEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjYW5jZWwgZ3Vlc3Qgb3JkZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS92MS9vcmRlcnMvY2FuY2VsLWd1ZXN0JylcbiAgICAgICAgLnNldCgneC1zZXNzaW9uLWlkJywgdGVzdFNlc3Npb25JZClcbiAgICAgICAgLnNlbmQoe1xuICAgICAgICAgIG9yZGVySWQ6IHRlc3RPcmRlcklkXG4gICAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50by5lcXVhbCgyMDApO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuc3VjY2VzcykudG8uYmUudHJ1ZTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmlzR3Vlc3QpLnRvLmJlLnRydWU7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGdldCBndWVzdCBvcmRlciBwcm9ncmVzcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIENyZWF0ZSBhIG5ldyBvcmRlciBmb3IgcHJvZ3Jlc3MgdGVzdGluZ1xuICAgICAgY29uc3QgcGxhY2VSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS92MS9vcmRlcnMvcGxhY2UtZ3Vlc3QtY2F0YWxvZycpXG4gICAgICAgIC5zZXQoJ3gtc2Vzc2lvbi1pZCcsIHRlc3RTZXNzaW9uSWQpXG4gICAgICAgIC5zZW5kKHtcbiAgICAgICAgICBjYXRhbG9nSWQ6IHRlc3RDYXRhbG9nSWQsXG4gICAgICAgICAgaXRlbXM6IFt7XG4gICAgICAgICAgICBwcm9kdWN0SWQ6IHRlc3RQcm9kdWN0SWQsXG4gICAgICAgICAgICBxdWFudGl0eTogMSxcbiAgICAgICAgICAgIG5hbWU6ICdUZXN0IFByb2R1Y3QnLFxuICAgICAgICAgICAgcHJpY2U6IDEwLjk5XG4gICAgICAgICAgfV0sXG4gICAgICAgICAgcGhvbmU6ICcxMjM0NTY3ODkwJyxcbiAgICAgICAgICBkZWxpdmVyeUFkZHJlc3M6ICdUZXN0IEFkZHJlc3MnLFxuICAgICAgICAgIGlzVGFrZW91dDogZmFsc2UsXG4gICAgICAgICAgZGVsaXZlcnlGZWU6IDIuOTlcbiAgICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IG5ld09yZGVySWQgPSBwbGFjZVJlc3BvbnNlLmJvZHkub3JkZXJJZDtcblxuICAgICAgY29uc3QgcHJvZ3Jlc3NSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KGAvYXBpL3YxL29yZGVycy9ndWVzdC1wcm9ncmVzcy8ke25ld09yZGVySWR9YClcbiAgICAgICAgLnNldCgneC1zZXNzaW9uLWlkJywgdGVzdFNlc3Npb25JZCk7XG5cbiAgICAgIGV4cGVjdChwcm9ncmVzc1Jlc3BvbnNlLnN0YXR1cykudG8uZXF1YWwoMjAwKTtcbiAgICAgIGV4cGVjdChwcm9ncmVzc1Jlc3BvbnNlLmJvZHkuc3VjY2VzcykudG8uYmUudHJ1ZTtcbiAgICAgIGV4cGVjdChwcm9ncmVzc1Jlc3BvbnNlLmJvZHkuZGF0YSkudG8uaGF2ZS5wcm9wZXJ0eSgncHJvZ3Jlc3NQcmVwYXJlJyk7XG4gICAgICBleHBlY3QocHJvZ3Jlc3NSZXNwb25zZS5ib2R5LmRhdGEpLnRvLmhhdmUucHJvcGVydHkoJ21pbnV0ZXNMZWZ0UHJlcGFyZScpO1xuICAgICAgZXhwZWN0KHByb2dyZXNzUmVzcG9uc2UuYm9keS5pc0d1ZXN0KS50by5iZS50cnVlO1xuICAgIH0pO1xuICB9KTtcblxuICBhZnRlcihhc3luYyAoKSA9PiB7XG4gICAgLy8gQ2xlYW51cFxuICAgIGF3YWl0IGNhcnRNb2RlbC5kZWxldGVNYW55KHsgc2Vzc2lvbjogdGVzdFNlc3Npb25JZCB9KTtcbiAgICBhd2FpdCBvcmRlck1vZGVsLmRlbGV0ZU1hbnkoeyBndWVzdFNlc3Npb25JZDogdGVzdFNlc3Npb25JZCB9KTtcbiAgICBhd2FpdCBwcm9kdWN0TW9kZWwuZGVsZXRlTWFueSh7IG5hbWU6ICdUZXN0IFByb2R1Y3QnIH0pO1xuICAgIGF3YWl0IGNhdGFsb2dNb2RlbC5kZWxldGVNYW55KHsgbmFtZTogJ1Rlc3QgQ2F0YWxvZycgfSk7XG4gIH0pO1xufSk7Il0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU07RUFBRUE7QUFBTyxDQUFDLEdBQUdDLE9BQU8sQ0FBQyxNQUFNLENBQUM7QUFDbEMsTUFBTUMsT0FBTyxHQUFHRCxPQUFPLENBQUMsV0FBVyxDQUFDO0FBQ3BDLE1BQU1FLEdBQUcsR0FBR0YsT0FBTyxDQUFDLFdBQVcsQ0FBQztBQUNoQyxNQUFNRyxVQUFVLEdBQUdILE9B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","map":{"version":3,"names":["expect","require","request","app","orderModel","cartModel","productModel","catalogModel","describe","testSessionId","testProductId","testCatalogId","before","product","name","description","price","available","stock","store","category","save","_id","catalog","isPublic","isActive","ownerId","products","addedAt","Date","deleteMany","session","guestSessionId","it","response","post","set","send","itemId","quantity","status","to","equal","body","success","be","true","get","data","an","isGuest","length","cart","have","property","items","nested","cartResponse","testOrderId","catalogId","productId","phone","deliveryAddress","isTakeout","deliveryFee","orderId","at","least","placeResponse","newOrderId","progressResponse","after"],"sourceRoot":"/Users/ahmad/Documents/projects/zero-project/backend/tests/","sources":["guest-functionality.test.js"],"sourcesContent":["const { expect } = require('chai');\nconst request = require('supertest');\nconst app = require('../server');\nconst orderModel = require('../models/orderModel');\nconst cartModel = require('../models/cartModel');\nconst productModel = require('../models/productModel');\nconst catalogModel = require('../models/catalogModel');\n\ndescribe('Guest User Functionality', () => {\n  const testSessionId = 'test-guest-session-123';\n  let testProductId;\n  let testCatalogId;\n\n  before(async () => {\n    // Setup test data - create a test product and catalog\n    const product = new productModel({\n      name: 'Test Product',\n      description: 'Test product for guest functionality',\n      price: 10.99,\n      available: true,\n      stock: 100,\n      store: 'test-store-id',\n      category: 'test-category-id'\n    });\n    await product.save();\n    testProductId = product._id;\n\n    const catalog = new catalogModel({\n      name: 'Test Catalog',\n      store: 'test-store-id',\n      description: 'Test catalog for guest functionality',\n      isPublic: true,\n      isActive: true,\n      ownerId: 'test-store-id',\n      products: [{\n        product: testProductId,\n        addedAt: new Date()\n      }]\n    });\n    await catalog.save();\n    testCatalogId = catalog._id;\n\n    // Clean up any existing test data\n    await cartModel.deleteMany({ session: testSessionId });\n    await orderModel.deleteMany({ guestSessionId: testSessionId });\n  });\n\n  describe('Guest Cart Operations', () => {\n    it('should add items to guest cart', async () => {\n      const response = await request(app)\n        .post('/api/v1/cart/guest')\n        .set('x-session-id', testSessionId)\n        .send({\n          itemId: testProductId,\n          quantity: 2\n        });\n\n      expect(response.status).to.equal(200);\n      expect(response.body.success).to.be.true;\n    });\n\n    it('should get guest cart with standardized structure', async () => {\n      const response = await request(app)\n        .get('/api/v1/cart/guest')\n        .set('x-session-id', testSessionId);\n\n      expect(response.status).to.equal(200);\n      expect(response.body.success).to.be.true;\n      expect(response.body.data).to.be.an('array');\n      expect(response.body.isGuest).to.be.true;\n\n      if (response.body.data.length > 0) {\n        const cart = response.body.data[0];\n        expect(cart).to.have.property('items');\n        expect(cart.items[0]).to.have.nested.property('product._id');\n        expect(cart.items[0]).to.have.nested.property('product.name');\n        expect(cart.items[0].product.name).to.equal('Test Product');\n      }\n    });\n\n    it('should clear guest cart', async () => {\n      // First add an item to ensure there's something to clear\n      await request(app)\n        .post('/api/v1/cart/guest')\n        .set('x-session-id', testSessionId)\n        .send({\n          itemId: testProductId,\n          quantity: 1\n        });\n\n      // Now clear the cart\n      const response = await request(app)\n        .post('/api/v1/cart/guest/clear')\n        .set('x-session-id', testSessionId);\n\n      expect(response.status).to.equal(200);\n      expect(response.body.success).to.be.true;\n      expect(response.body.isGuest).to.be.true;\n\n      // Verify cart is empty\n      const cartResponse = await request(app)\n        .get('/api/v1/cart/guest')\n        .set('x-session-id', testSessionId);\n\n      expect(cartResponse.body.data).to.be.an('array');\n      expect(cartResponse.body.data.length).to.equal(0);\n    });\n  });\n\n  describe('Guest Order Operations', () => {\n    let testOrderId;\n\n    it('should place guest order', async () => {\n      // First add item to cart\n      await request(app)\n        .post('/api/v1/cart/guest')\n        .set('x-session-id', testSessionId)\n        .send({\n          itemId: testProductId,\n          quantity: 1\n        });\n\n      // Then place order\n      const response = await request(app)\n        .post('/api/v1/orders/place-guest-catalog')\n        .set('x-session-id', testSessionId)\n        .send({\n          catalogId: testCatalogId,\n          items: [{\n            productId: testProductId,\n            quantity: 1,\n            name: 'Test Product',\n            price: 10.99\n          }],\n          phone: '1234567890',\n          deliveryAddress: 'Test Address',\n          isTakeout: false,\n          deliveryFee: 2.99\n        });\n\n      expect(response.status).to.equal(200);\n      expect(response.body.success).to.be.true;\n      expect(response.body).to.have.property('orderId');\n      expect(response.body.isGuest).to.be.true;\n      testOrderId = response.body.orderId;\n    });\n\n    it('should get guest orders', async () => {\n      const response = await request(app)\n        .post('/api/v1/orders/guest-orders')\n        .set('x-session-id', testSessionId)\n        .send({});\n\n      expect(response.status).to.equal(200);\n      expect(response.body.success).to.be.true;\n      expect(response.body.data).to.be.an('array');\n      expect(response.body.data.length).to.be.at.least(1);\n    });\n\n    it('should cancel guest order', async () => {\n      const response = await request(app)\n        .post('/api/v1/orders/cancel-guest')\n        .set('x-session-id', testSessionId)\n        .send({\n          orderId: testOrderId\n        });\n\n      expect(response.status).to.equal(200);\n      expect(response.body.success).to.be.true;\n      expect(response.body.isGuest).to.be.true;\n    });\n\n    it('should get guest order progress', async () => {\n      // Create a new order for progress testing\n      const placeResponse = await request(app)\n        .post('/api/v1/orders/place-guest-catalog')\n        .set('x-session-id', testSessionId)\n        .send({\n          catalogId: testCatalogId,\n          items: [{\n            productId: testProductId,\n            quantity: 1,\n            name: 'Test Product',\n            price: 10.99\n          }],\n          phone: '1234567890',\n          deliveryAddress: 'Test Address',\n          isTakeout: false,\n          deliveryFee: 2.99\n        });\n\n      const newOrderId = placeResponse.body.orderId;\n\n      const progressResponse = await request(app)\n        .get(`/api/v1/orders/guest-progress/${newOrderId}`)\n        .set('x-session-id', testSessionId);\n\n      expect(progressResponse.status).to.equal(200);\n      expect(progressResponse.body.success).to.be.true;\n      expect(progressResponse.body.data).to.have.property('progressPrepare');\n      expect(progressResponse.body.data).to.have.property('minutesLeftPrepare');\n      expect(progressResponse.body.isGuest).to.be.true;\n    });\n  });\n\n  after(async () => {\n    // Cleanup\n    await cartModel.deleteMany({ session: testSessionId });\n    await orderModel.deleteMany({ guestSessionId: testSessionId });\n    await productModel.deleteMany({ name: 'Test Product' });\n    await catalogModel.deleteMany({ name: 'Test Catalog' });\n  });\n});"],"mappings":"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","ignoreList":[]}},"mtime":1765958099288},"{\"assumptions\":{},\"sourceRoot\":\"/Users/ahmad/Documents/projects/zero-project/backend/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/ahmad/Documents/projects/zero-project/backend\",\"filename\":\"/Users/ahmad/Documents/projects/zero-project/backend/server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/ahmad/Documents/projects/zero-project/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-explicit-resource-management\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"BlockStatement\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$12\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$17\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.28.5:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"dotenv/config\");\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _path = _interopRequireDefault(require(\"path\"));\nvar _url = require(\"url\");\nvar _db = require(\"./config/db.js\");\nvar _swagger = require(\"./utils/swagger.js\");\nvar _unifiedMiddleware = require(\"./middleware/unifiedMiddleware.js\");\nvar _errorHandler = require(\"./middleware/errorHandler.js\");\nvar _apiResponse = require(\"./utils/apiResponse.js\");\nvar _userRoute = _interopRequireDefault(require(\"./routes/userRoute.js\"));\nvar _productRoute = _interopRequireDefault(require(\"./routes/productRoute.js\"));\nvar _categoryRoute = _interopRequireDefault(require(\"./routes/categoryRoute.js\"));\nvar _cartRoute = _interopRequireDefault(require(\"./routes/cartRoute.js\"));\nvar _orderRoute = _interopRequireDefault(require(\"./routes/orderRoute.js\"));\nvar _messageRoute = _interopRequireDefault(require(\"./routes/messageRoute.js\"));\nvar _socialRoute = _interopRequireDefault(require(\"./routes/socialRoute.js\"));\nvar _groupRoute = _interopRequireDefault(require(\"./routes/groupRoute.js\"));\nvar _commentRoute = _interopRequireDefault(require(\"./routes/commentRoute.js\"));\nvar _imageRoute = _interopRequireDefault(require(\"./routes/imageRoute.js\"));\nvar _adminRoute = _interopRequireDefault(require(\"./routes/adminRoute.js\"));\nvar _invitationRoute = _interopRequireDefault(require(\"./routes/invitationRoute.js\"));\nvar _catalogRoute = _interopRequireDefault(require(\"./routes/catalogRoute.js\"));\nrequire(\"./models/userModel.js\");\nrequire(\"./models/productModel.js\");\nrequire(\"./models/categoryModel.js\");\nrequire(\"./models/orderModel.js\");\nrequire(\"./models/commentModel.js\");\nrequire(\"./models/messageModel.js\");\nrequire(\"./models/socialModel.js\");\nrequire(\"./models/groupModel.js\");\nrequire(\"./models/productReactionModel.js\");\nrequire(\"./models/invitationModel.js\");\nrequire(\"./models/catalogModel.js\");\nrequire(\"./models/sessionModel.js\");\nrequire(\"./models/cartModel.js\");\nvar _sessionCleanup = _interopRequireDefault(require(\"./utils/sessionCleanup.js\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n// Import routers\n\n// Import models to register them with Mongoose\n\nconst _filename = (0, _url.fileURLToPath)(import.meta.url);\nconst _dirname = _path.default.dirname(_filename);\n\n// Create Express app\nconst app = (0, _express.default)();\nconst port = process.env.PORT || 3000;\n\n// Setup all middleware\n(0, _unifiedMiddleware.setupMiddleware)(app);\n\n// Setup Swagger documentation\n(0, _swagger.setupSwaggerUI)(app);\n\n// API endpoints with versioning\napp.use(\"/api/v1/user\", _userRoute.default);\napp.use(\"/api/v1/product\", _productRoute.default);\napp.use(\"/api/v1/category\", _categoryRoute.default);\napp.use(\"/api/v1/cart\", _cartRoute.default);\napp.use(\"/api/v1/orders\", _orderRoute.default);\napp.use(\"/api/v1/message\", _messageRoute.default);\napp.use(\"/api/v1/social\", _socialRoute.default);\napp.use(\"/api/v1/group\", _groupRoute.default);\napp.use(\"/api/v1/comment\", _commentRoute.default);\napp.use(\"/api/v1/image\", _imageRoute.default);\napp.use(\"/api/v1/admin\", _adminRoute.default);\napp.use(\"/api/v1/invitation\", _invitationRoute.default);\napp.use(\"/api/v1/catalog\", _catalogRoute.default);\n\n// Health check endpoint (standardized)\napp.get('/health', async (req, res) => {\n  try {\n    const dbReadyState = _mongoose.default.connection.readyState;\n    const sessionStats = await _sessionCleanup.default.getCleanupStats();\n    const healthData = {\n      status: dbReadyState === 1 ? 'healthy' : 'degraded',\n      timestamp: new Date().toISOString(),\n      database: {\n        status: dbReadyState === 1 ? 'connected' : 'disconnected',\n        readyState: dbReadyState\n      },\n      sessions: sessionStats,\n      uptime: process.uptime(),\n      memory: process.memoryUsage()\n    };\n    (0, _apiResponse.successResponse)(res, healthData, \"Health check successful\");\n  } catch (error) {\n    (0, _apiResponse.errorResponse)(res, \"Health check failed\", error, 500);\n  }\n});\n\n// Session cleanup manual trigger (for testing)\napp.post('/admin/cleanup-sessions', async (req, res) => {\n  try {\n    const result = await _sessionCleanup.default.manualCleanup();\n    (0, _apiResponse.successResponse)(res, {\n      message: 'Manual session cleanup completed',\n      result: result\n    });\n  } catch (error) {\n    (0, _apiResponse.errorResponse)(res, \"Session cleanup failed\", error, 500);\n  }\n});\n\n// Root endpoint (standardized)\napp.get(\"/\", (req, res) => {\n  (0, _apiResponse.successResponse)(res, {\n    message: \"Zero Community Backend API\",\n    status: \"running\",\n    version: \"1.0.0\",\n    documentation: \"/api-docs\",\n    endpoints: {\n      health: \"/health\",\n      api: \"/api/v1/*\"\n    }\n  });\n});\n\n// Error handling middleware\napp.use(_errorHandler.notFoundHandler);\napp.use(_errorHandler.errorHandler);\n\n// Import session cleanup\n\n// Connect to database and start server\nconst startServer = async () => {\n  try {\n    await (0, _db.connectDB)();\n\n    // Start session cleanup job\n    _sessionCleanup.default.start();\n    app.listen(port, () => {\n      console.log(` Zero Community Backend API v1.0.0 running on http://localhost:${port}`);\n      console.log(' Health check: /health');\n      console.log(' API Documentation: /api-docs');\n      console.log(' All API endpoints now use /api/v1/ prefix');\n      console.log(' Session cleanup job started (automatic guest session cleanup)');\n    });\n  } catch (error) {\n    console.error('Failed to start server:', error);\n    process.exit(1);\n  }\n};\nstartServer();\nvar _default = exports.default = app;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyZXF1aXJlIiwiX2V4cHJlc3MiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX21vbmdvb3NlIiwiX3BhdGgiLCJfdXJsIiwiX2RiIiwiX3N3YWdnZXIiLCJfdW5pZmllZE1pZGRsZXdhcmUiLCJfZXJyb3JIYW5kbGVyIiwiX2FwaVJlc3BvbnNlIiwiX3VzZXJSb3V0ZSIsIl9wcm9kdWN0Um91dGUiLCJfY2F0ZWdvcnlSb3V0ZSIsIl9jYXJ0Um91dGUiLCJfb3JkZXJSb3V0ZSIsIl9tZXNzYWdlUm91dGUiLCJfc29jaWFsUm91dGUiLCJfZ3JvdXBSb3V0ZSIsIl9jb21tZW50Um91dGUiLCJfaW1hZ2VSb3V0ZSIsIl9hZG1pblJvdXRlIiwiX2ludml0YXRpb25Sb3V0ZSIsIl9jYXRhbG9nUm91dGUiLCJfc2Vzc2lvbkNsZWFudXAiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfX2ZpbGVuYW1lIiwiZmlsZVVSTFRvUGF0aCIsImltcG9ydCIsIm1ldGEiLCJ1cmwiLCJfX2Rpcm5hbWUiLCJwYXRoIiwiZGlybmFtZSIsImFwcCIsImV4cHJlc3MiLCJwb3J0IiwicHJvY2VzcyIsImVudiIsIlBPUlQiLCJzZXR1cE1pZGRsZXdhcmUiLCJzZXR1cFN3YWdnZXJVSSIsInVzZSIsInVzZXJSb3V0ZXIiLCJwcm9kdWN0Um91dGVyIiwiY2F0ZWdvcnlSb3V0ZXIiLCJjYXJ0Um91dGVyIiwib3JkZXJSb3V0ZXIiLCJtZXNzYWdlUm91dGVyIiwic29jaWFsUm91dGVyIiwiZ3JvdXBSb3V0ZXIiLCJjb21tZW50Um91dGVyIiwiaW1hZ2VSb3V0ZXIiLCJhZG1pblJvdXRlciIsImludml0YXRpb25Sb3V0ZXIiLCJjYXRhbG9nUm91dGVyIiwiZ2V0IiwicmVxIiwicmVzIiwiZGJSZWFkeVN0YXRlIiwibW9uZ29vc2UiLCJjb25uZWN0aW9uIiwicmVhZHlTdGF0ZSIsInNlc3Npb25TdGF0cyIsInNlc3Npb25DbGVhbnVwIiwiZ2V0Q2xlYW51cFN0YXRzIiwiaGVhbHRoRGF0YSIsInN0YXR1cyIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImRhdGFiYXNlIiwic2Vzc2lvbnMiLCJ1cHRpbWUiLCJtZW1vcnkiLCJtZW1vcnlVc2FnZSIsInN1Y2Nlc3NSZXNwb25zZSIsImVycm9yIiwiZXJyb3JSZXNwb25zZSIsInBvc3QiLCJyZXN1bHQiLCJtYW51YWxDbGVhbnVwIiwibWVzc2FnZSIsInZlcnNpb24iLCJkb2N1bWVudGF0aW9uIiwiZW5kcG9pbnRzIiwiaGVhbHRoIiwiYXBpIiwibm90Rm91bmRIYW5kbGVyIiwiZXJyb3JIYW5kbGVyIiwic3RhcnRTZXJ2ZXIiLCJjb25uZWN0REIiLCJzdGFydCIsImxpc3RlbiIsImNvbnNvbGUiLCJsb2ciLCJleGl0IiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYWhtYWQvRG9jdW1lbnRzL3Byb2plY3RzL3plcm8tcHJvamVjdC9iYWNrZW5kLyIsInNvdXJjZXMiOlsic2VydmVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBcImRvdGVudi9jb25maWdcIjtcbmltcG9ydCBleHByZXNzIGZyb20gXCJleHByZXNzXCI7XG5pbXBvcnQgbW9uZ29vc2UgZnJvbSBcIm1vbmdvb3NlXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IHsgZmlsZVVSTFRvUGF0aCB9IGZyb20gXCJ1cmxcIjtcbmltcG9ydCB7IGNvbm5lY3REQiB9IGZyb20gXCIuL2NvbmZpZy9kYi5qc1wiO1xuaW1wb3J0IHsgc2V0dXBTd2FnZ2VyVUkgfSBmcm9tIFwiLi91dGlscy9zd2FnZ2VyLmpzXCI7XG5pbXBvcnQgeyBzZXR1cE1pZGRsZXdhcmUgfSBmcm9tIFwiLi9taWRkbGV3YXJlL3VuaWZpZWRNaWRkbGV3YXJlLmpzXCI7XG5pbXBvcnQgeyBlcnJvckhhbmRsZXIsIG5vdEZvdW5kSGFuZGxlciB9IGZyb20gXCIuL21pZGRsZXdhcmUvZXJyb3JIYW5kbGVyLmpzXCI7XG5pbXBvcnQgeyBzdWNjZXNzUmVzcG9uc2UsIGVycm9yUmVzcG9uc2UgfSBmcm9tIFwiLi91dGlscy9hcGlSZXNwb25zZS5qc1wiO1xuXG4vLyBJbXBvcnQgcm91dGVyc1xuaW1wb3J0IHVzZXJSb3V0ZXIgZnJvbSBcIi4vcm91dGVzL3VzZXJSb3V0ZS5qc1wiO1xuaW1wb3J0IHByb2R1Y3RSb3V0ZXIgZnJvbSBcIi4vcm91dGVzL3Byb2R1Y3RSb3V0ZS5qc1wiO1xuaW1wb3J0IGNhdGVnb3J5Um91dGVyIGZyb20gXCIuL3JvdXRlcy9jYXRlZ29yeVJvdXRlLmpzXCI7XG5pbXBvcnQgY2FydFJvdXRlciBmcm9tIFwiLi9yb3V0ZXMvY2FydFJvdXRlLmpzXCI7XG5pbXBvcnQgb3JkZXJSb3V0ZXIgZnJvbSBcIi4vcm91dGVzL29yZGVyUm91dGUuanNcIjtcbmltcG9ydCBtZXNzYWdlUm91dGVyIGZyb20gXCIuL3JvdXRlcy9tZXNzYWdlUm91dGUuanNcIjtcbmltcG9ydCBzb2NpYWxSb3V0ZXIgZnJvbSBcIi4vcm91dGVzL3NvY2lhbFJvdXRlLmpzXCI7XG5pbXBvcnQgZ3JvdXBSb3V0ZXIgZnJvbSBcIi4vcm91dGVzL2dyb3VwUm91dGUuanNcIjtcbmltcG9ydCBjb21tZW50Um91dGVyIGZyb20gXCIuL3JvdXRlcy9jb21tZW50Um91dGUuanNcIjtcbmltcG9ydCBpbWFnZVJvdXRlciBmcm9tIFwiLi9yb3V0ZXMvaW1hZ2VSb3V0ZS5qc1wiO1xuaW1wb3J0IGFkbWluUm91dGVyIGZyb20gXCIuL3JvdXRlcy9hZG1pblJvdXRlLmpzXCI7XG5pbXBvcnQgaW52aXRhdGlvblJvdXRlciBmcm9tIFwiLi9yb3V0ZXMvaW52aXRhdGlvblJvdXRlLmpzXCI7XG5pbXBvcnQgY2F0YWxvZ1JvdXRlciBmcm9tIFwiLi9yb3V0ZXMvY2F0YWxvZ1JvdXRlLmpzXCI7XG5cbi8vIEltcG9ydCBtb2RlbHMgdG8gcmVnaXN0ZXIgdGhlbSB3aXRoIE1vbmdvb3NlXG5pbXBvcnQgXCIuL21vZGVscy91c2VyTW9kZWwuanNcIjtcbmltcG9ydCBcIi4vbW9kZWxzL3Byb2R1Y3RNb2RlbC5qc1wiO1xuaW1wb3J0IFwiLi9tb2RlbHMvY2F0ZWdvcnlNb2RlbC5qc1wiO1xuaW1wb3J0IFwiLi9tb2RlbHMvb3JkZXJNb2RlbC5qc1wiO1xuaW1wb3J0IFwiLi9tb2RlbHMvY29tbWVudE1vZGVsLmpzXCI7XG5pbXBvcnQgXCIuL21vZGVscy9tZXNzYWdlTW9kZWwuanNcIjtcbmltcG9ydCBcIi4vbW9kZWxzL3NvY2lhbE1vZGVsLmpzXCI7XG5pbXBvcnQgXCIuL21vZGVscy9ncm91cE1vZGVsLmpzXCI7XG5pbXBvcnQgXCIuL21vZGVscy9wcm9kdWN0UmVhY3Rpb25Nb2RlbC5qc1wiO1xuaW1wb3J0IFwiLi9tb2RlbHMvaW52aXRhdGlvbk1vZGVsLmpzXCI7XG5pbXBvcnQgXCIuL21vZGVscy9jYXRhbG9nTW9kZWwuanNcIjtcbmltcG9ydCBcIi4vbW9kZWxzL3Nlc3Npb25Nb2RlbC5qc1wiO1xuaW1wb3J0IFwiLi9tb2RlbHMvY2FydE1vZGVsLmpzXCI7XG5cbmNvbnN0IF9fZmlsZW5hbWUgPSBmaWxlVVJMVG9QYXRoKGltcG9ydC5tZXRhLnVybCk7XG5jb25zdCBfX2Rpcm5hbWUgPSBwYXRoLmRpcm5hbWUoX19maWxlbmFtZSk7XG5cbi8vIENyZWF0ZSBFeHByZXNzIGFwcFxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xuY29uc3QgcG9ydCA9IHByb2Nlc3MuZW52LlBPUlQgfHwgMzAwMDtcblxuLy8gU2V0dXAgYWxsIG1pZGRsZXdhcmVcbnNldHVwTWlkZGxld2FyZShhcHApO1xuXG4vLyBTZXR1cCBTd2FnZ2VyIGRvY3VtZW50YXRpb25cbnNldHVwU3dhZ2dlclVJKGFwcCk7XG5cbi8vIEFQSSBlbmRwb2ludHMgd2l0aCB2ZXJzaW9uaW5nXG5hcHAudXNlKFwiL2FwaS92MS91c2VyXCIsIHVzZXJSb3V0ZXIpO1xuYXBwLnVzZShcIi9hcGkvdjEvcHJvZHVjdFwiLCBwcm9kdWN0Um91dGVyKTtcbmFwcC51c2UoXCIvYXBpL3YxL2NhdGVnb3J5XCIsIGNhdGVnb3J5Um91dGVyKTtcbmFwcC51c2UoXCIvYXBpL3YxL2NhcnRcIiwgY2FydFJvdXRlcik7XG5hcHAudXNlKFwiL2FwaS92MS9vcmRlcnNcIiwgb3JkZXJSb3V0ZXIpO1xuYXBwLnVzZShcIi9hcGkvdjEvbWVzc2FnZVwiLCBtZXNzYWdlUm91dGVyKTtcbmFwcC51c2UoXCIvYXBpL3YxL3NvY2lhbFwiLCBzb2NpYWxSb3V0ZXIpO1xuYXBwLnVzZShcIi9hcGkvdjEvZ3JvdXBcIiwgZ3JvdXBSb3V0ZXIpO1xuYXBwLnVzZShcIi9hcGkvdjEvY29tbWVudFwiLCBjb21tZW50Um91dGVyKTtcbmFwcC51c2UoXCIvYXBpL3YxL2ltYWdlXCIsIGltYWdlUm91dGVyKTtcbmFwcC51c2UoXCIvYXBpL3YxL2FkbWluXCIsIGFkbWluUm91dGVyKTtcbmFwcC51c2UoXCIvYXBpL3YxL2ludml0YXRpb25cIiwgaW52aXRhdGlvblJvdXRlcik7XG5hcHAudXNlKFwiL2FwaS92MS9jYXRhbG9nXCIsIGNhdGFsb2dSb3V0ZXIpO1xuXG4vLyBIZWFsdGggY2hlY2sgZW5kcG9pbnQgKHN0YW5kYXJkaXplZClcbmFwcC5nZXQoJy9oZWFsdGgnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBkYlJlYWR5U3RhdGUgPSBtb25nb29zZS5jb25uZWN0aW9uLnJlYWR5U3RhdGU7XG4gICAgY29uc3Qgc2Vzc2lvblN0YXRzID0gYXdhaXQgc2Vzc2lvbkNsZWFudXAuZ2V0Q2xlYW51cFN0YXRzKCk7XG5cbiAgICBjb25zdCBoZWFsdGhEYXRhID0ge1xuICAgICAgc3RhdHVzOiBkYlJlYWR5U3RhdGUgPT09IDEgPyAnaGVhbHRoeScgOiAnZGVncmFkZWQnLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBkYXRhYmFzZToge1xuICAgICAgICBzdGF0dXM6IGRiUmVhZHlTdGF0ZSA9PT0gMSA/ICdjb25uZWN0ZWQnIDogJ2Rpc2Nvbm5lY3RlZCcsXG4gICAgICAgIHJlYWR5U3RhdGU6IGRiUmVhZHlTdGF0ZVxuICAgICAgfSxcbiAgICAgIHNlc3Npb25zOiBzZXNzaW9uU3RhdHMsXG4gICAgICB1cHRpbWU6IHByb2Nlc3MudXB0aW1lKCksXG4gICAgICBtZW1vcnk6IHByb2Nlc3MubWVtb3J5VXNhZ2UoKVxuICAgIH07XG4gICAgc3VjY2Vzc1Jlc3BvbnNlKHJlcywgaGVhbHRoRGF0YSwgXCJIZWFsdGggY2hlY2sgc3VjY2Vzc2Z1bFwiKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBlcnJvclJlc3BvbnNlKHJlcywgXCJIZWFsdGggY2hlY2sgZmFpbGVkXCIsIGVycm9yLCA1MDApO1xuICB9XG59KTtcblxuLy8gU2Vzc2lvbiBjbGVhbnVwIG1hbnVhbCB0cmlnZ2VyIChmb3IgdGVzdGluZylcbmFwcC5wb3N0KCcvYWRtaW4vY2xlYW51cC1zZXNzaW9ucycsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlc3Npb25DbGVhbnVwLm1hbnVhbENsZWFudXAoKTtcbiAgICBzdWNjZXNzUmVzcG9uc2UocmVzLCB7XG4gICAgICBtZXNzYWdlOiAnTWFudWFsIHNlc3Npb24gY2xlYW51cCBjb21wbGV0ZWQnLFxuICAgICAgcmVzdWx0OiByZXN1bHRcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBlcnJvclJlc3BvbnNlKHJlcywgXCJTZXNzaW9uIGNsZWFudXAgZmFpbGVkXCIsIGVycm9yLCA1MDApO1xuICB9XG59KTtcblxuLy8gUm9vdCBlbmRwb2ludCAoc3RhbmRhcmRpemVkKVxuYXBwLmdldChcIi9cIiwgKHJlcSwgcmVzKSA9PiB7XG4gIHN1Y2Nlc3NSZXNwb25zZShyZXMsIHtcbiAgICBtZXNzYWdlOiBcIlplcm8gQ29tbXVuaXR5IEJhY2tlbmQgQVBJXCIsXG4gICAgc3RhdHVzOiBcInJ1bm5pbmdcIixcbiAgICB2ZXJzaW9uOiBcIjEuMC4wXCIsXG4gICAgZG9jdW1lbnRhdGlvbjogXCIvYXBpLWRvY3NcIixcbiAgICBlbmRwb2ludHM6IHtcbiAgICAgIGhlYWx0aDogXCIvaGVhbHRoXCIsXG4gICAgICBhcGk6IFwiL2FwaS92MS8qXCJcbiAgICB9XG4gIH0pO1xufSk7XG5cbi8vIEVycm9yIGhhbmRsaW5nIG1pZGRsZXdhcmVcbmFwcC51c2Uobm90Rm91bmRIYW5kbGVyKTtcbmFwcC51c2UoZXJyb3JIYW5kbGVyKTtcblxuLy8gSW1wb3J0IHNlc3Npb24gY2xlYW51cFxuaW1wb3J0IHNlc3Npb25DbGVhbnVwIGZyb20gXCIuL3V0aWxzL3Nlc3Npb25DbGVhbnVwLmpzXCI7XG5cbi8vIENvbm5lY3QgdG8gZGF0YWJhc2UgYW5kIHN0YXJ0IHNlcnZlclxuY29uc3Qgc3RhcnRTZXJ2ZXIgPSBhc3luYyAoKSA9PiB7XG4gIHRyeSB7XG4gICAgYXdhaXQgY29ubmVjdERCKCk7XG5cbiAgICAvLyBTdGFydCBzZXNzaW9uIGNsZWFudXAgam9iXG4gICAgc2Vzc2lvbkNsZWFudXAuc3RhcnQoKTtcblxuICAgIGFwcC5saXN0ZW4ocG9ydCwgKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coYPCfmoAgWmVybyBDb21tdW5pdHkgQmFja2VuZCBBUEkgdjEuMC4wIHJ1bm5pbmcgb24gaHR0cDovL2xvY2FsaG9zdDoke3BvcnR9YCk7XG4gICAgICBjb25zb2xlLmxvZygn8J+TiiBIZWFsdGggY2hlY2s6IC9oZWFsdGgnKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5OWIEFQSSBEb2N1bWVudGF0aW9uOiAvYXBpLWRvY3MnKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SSIEFsbCBBUEkgZW5kcG9pbnRzIG5vdyB1c2UgL2FwaS92MS8gcHJlZml4Jyk7XG4gICAgICBjb25zb2xlLmxvZygn8J+nuSBTZXNzaW9uIGNsZWFudXAgam9iIHN0YXJ0ZWQgKGF1dG9tYXRpYyBndWVzdCBzZXNzaW9uIGNsZWFudXApJyk7XG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHN0YXJ0IHNlcnZlcjonLCBlcnJvcik7XG4gICAgcHJvY2Vzcy5leGl0KDEpO1xuICB9XG59O1xuXG5zdGFydFNlcnZlcigpO1xuXG5leHBvcnQgZGVmYXVsdCBhcHA7Il0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQUEsT0FBQTtBQUNBLElBQUFDLFFBQUEsR0FBQUMsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFHLFNBQUEsR0FBQUQsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFJLEtBQUEsR0FBQUYsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFLLElBQUEsR0FBQUwsT0FBQTtBQUNBLElBQUFNLEdBQUEsR0FBQU4sT0FBQTtBQUNBLElBQUFPLFFBQUEsR0FBQVAsT0FBQTtBQUNBLElBQUFRLGtCQUFBLEdBQUFSLE9BQUE7QUFDQSxJQUFBUyxhQUFBLEdBQUFULE9BQUE7QUFDQSxJQUFBVSxZQUFBLEdBQUFWLE9BQUE7QUFHQSxJQUFBVyxVQUFBLEdBQUFULHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBWSxhQUFBLEdBQUFWLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBYSxjQUFBLEdBQUFYLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBYyxVQUFBLEdBQUFaLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBZSxXQUFBLEdBQUFiLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBZ0IsYUFBQSxHQUFBZCxzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQWlCLFlBQUEsR0FBQWYsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFrQixXQUFBLEdBQUFoQixzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQW1CLGFBQUEsR0FBQWpCLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBb0IsV0FBQSxHQUFBbEIsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFxQixXQUFBLEdBQUFuQixzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQXNCLGdCQUFBLEdBQUFwQixzQkFBQSxDQUFBRixPQUFB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","map":{"version":3,"names":["require","_express","_interopRequireDefault","_mongoose","_path","_url","_db","_swagger","_unifiedMiddleware","_errorHandler","_apiResponse","_userRoute","_productRoute","_categoryRoute","_cartRoute","_orderRoute","_messageRoute","_socialRoute","_groupRoute","_commentRoute","_imageRoute","_adminRoute","_invitationRoute","_catalogRoute","_sessionCleanup","e","__esModule","default","__filename","fileURLToPath","import","meta","url","__dirname","path","dirname","app","express","port","process","env","PORT","setupMiddleware","setupSwaggerUI","use","userRouter","productRouter","categoryRouter","cartRouter","orderRouter","messageRouter","socialRouter","groupRouter","commentRouter","imageRouter","adminRouter","invitationRouter","catalogRouter","get","req","res","dbReadyState","mongoose","connection","readyState","sessionStats","sessionCleanup","getCleanupStats","healthData","status","timestamp","Date","toISOString","database","sessions","uptime","memory","memoryUsage","successResponse","error","errorResponse","post","result","manualCleanup","message","version","documentation","endpoints","health","api","notFoundHandler","errorHandler","startServer","connectDB","start","listen","console","log","exit","_default","exports"],"sourceRoot":"/Users/ahmad/Documents/projects/zero-project/backend/","sources":["server.js"],"sourcesContent":["import \"dotenv/config\";\nimport express from \"express\";\nimport mongoose from \"mongoose\";\nimport path from \"path\";\nimport { fileURLToPath } from \"url\";\nimport { connectDB } from \"./config/db.js\";\nimport { setupSwaggerUI } from \"./utils/swagger.js\";\nimport { setupMiddleware } from \"./middleware/unifiedMiddleware.js\";\nimport { errorHandler, notFoundHandler } from \"./middleware/errorHandler.js\";\nimport { successResponse, errorResponse } from \"./utils/apiResponse.js\";\n\n// Import routers\nimport userRouter from \"./routes/userRoute.js\";\nimport productRouter from \"./routes/productRoute.js\";\nimport categoryRouter from \"./routes/categoryRoute.js\";\nimport cartRouter from \"./routes/cartRoute.js\";\nimport orderRouter from \"./routes/orderRoute.js\";\nimport messageRouter from \"./routes/messageRoute.js\";\nimport socialRouter from \"./routes/socialRoute.js\";\nimport groupRouter from \"./routes/groupRoute.js\";\nimport commentRouter from \"./routes/commentRoute.js\";\nimport imageRouter from \"./routes/imageRoute.js\";\nimport adminRouter from \"./routes/adminRoute.js\";\nimport invitationRouter from \"./routes/invitationRoute.js\";\nimport catalogRouter from \"./routes/catalogRoute.js\";\n\n// Import models to register them with Mongoose\nimport \"./models/userModel.js\";\nimport \"./models/productModel.js\";\nimport \"./models/categoryModel.js\";\nimport \"./models/orderModel.js\";\nimport \"./models/commentModel.js\";\nimport \"./models/messageModel.js\";\nimport \"./models/socialModel.js\";\nimport \"./models/groupModel.js\";\nimport \"./models/productReactionModel.js\";\nimport \"./models/invitationModel.js\";\nimport \"./models/catalogModel.js\";\nimport \"./models/sessionModel.js\";\nimport \"./models/cartModel.js\";\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\n// Create Express app\nconst app = express();\nconst port = process.env.PORT || 3000;\n\n// Setup all middleware\nsetupMiddleware(app);\n\n// Setup Swagger documentation\nsetupSwaggerUI(app);\n\n// API endpoints with versioning\napp.use(\"/api/v1/user\", userRouter);\napp.use(\"/api/v1/product\", productRouter);\napp.use(\"/api/v1/category\", categoryRouter);\napp.use(\"/api/v1/cart\", cartRouter);\napp.use(\"/api/v1/orders\", orderRouter);\napp.use(\"/api/v1/message\", messageRouter);\napp.use(\"/api/v1/social\", socialRouter);\napp.use(\"/api/v1/group\", groupRouter);\napp.use(\"/api/v1/comment\", commentRouter);\napp.use(\"/api/v1/image\", imageRouter);\napp.use(\"/api/v1/admin\", adminRouter);\napp.use(\"/api/v1/invitation\", invitationRouter);\napp.use(\"/api/v1/catalog\", catalogRouter);\n\n// Health check endpoint (standardized)\napp.get('/health', async (req, res) => {\n  try {\n    const dbReadyState = mongoose.connection.readyState;\n    const sessionStats = await sessionCleanup.getCleanupStats();\n\n    const healthData = {\n      status: dbReadyState === 1 ? 'healthy' : 'degraded',\n      timestamp: new Date().toISOString(),\n      database: {\n        status: dbReadyState === 1 ? 'connected' : 'disconnected',\n        readyState: dbReadyState\n      },\n      sessions: sessionStats,\n      uptime: process.uptime(),\n      memory: process.memoryUsage()\n    };\n    successResponse(res, healthData, \"Health check successful\");\n  } catch (error) {\n    errorResponse(res, \"Health check failed\", error, 500);\n  }\n});\n\n// Session cleanup manual trigger (for testing)\napp.post('/admin/cleanup-sessions', async (req, res) => {\n  try {\n    const result = await sessionCleanup.manualCleanup();\n    successResponse(res, {\n      message: 'Manual session cleanup completed',\n      result: result\n    });\n  } catch (error) {\n    errorResponse(res, \"Session cleanup failed\", error, 500);\n  }\n});\n\n// Root endpoint (standardized)\napp.get(\"/\", (req, res) => {\n  successResponse(res, {\n    message: \"Zero Community Backend API\",\n    status: \"running\",\n    version: \"1.0.0\",\n    documentation: \"/api-docs\",\n    endpoints: {\n      health: \"/health\",\n      api: \"/api/v1/*\"\n    }\n  });\n});\n\n// Error handling middleware\napp.use(notFoundHandler);\napp.use(errorHandler);\n\n// Import session cleanup\nimport sessionCleanup from \"./utils/sessionCleanup.js\";\n\n// Connect to database and start server\nconst startServer = async () => {\n  try {\n    await connectDB();\n\n    // Start session cleanup job\n    sessionCleanup.start();\n\n    app.listen(port, () => {\n      console.log(` Zero Community Backend API v1.0.0 running on http://localhost:${port}`);\n      console.log(' Health check: /health');\n      console.log(' API Documentation: /api-docs');\n      console.log(' All API endpoints now use /api/v1/ prefix');\n      console.log(' Session cleanup job started (automatic guest session cleanup)');\n    });\n  } catch (error) {\n    console.error('Failed to start server:', error);\n    process.exit(1);\n  }\n};\n\nstartServer();\n\nexport default app;"],"mappings":"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","ignoreList":[]}},"mtime":1766340407652},"{\"assumptions\":{},\"sourceRoot\":\"/Users/ahmad/Documents/projects/zero-project/backend/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/ahmad/Documents/projects/zero-project/backend\",\"filename\":\"/Users/ahmad/Documents/projects/zero-project/backend/server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/ahmad/Documents/projects/zero-project/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-explicit-resource-management\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"BlockStatement\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$12\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/Users/ahmad/Documents/projects/zero-project/backend/node_modules/@babel/preset-env/lib/index.js$17\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.28.5:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"dotenv/config\");\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _path = _interopRequireDefault(require(\"path\"));\nvar _url = require(\"url\");\nvar _db = require(\"./config/db.js\");\nvar _swagger = require(\"./utils/swagger.js\");\nvar _unifiedMiddleware = require(\"./middleware/unifiedMiddleware.js\");\nvar _errorHandler = require(\"./middleware/errorHandler.js\");\nvar _apiResponse = require(\"./utils/apiResponse.js\");\nvar _userRoute = _interopRequireDefault(require(\"./routes/userRoute.js\"));\nvar _productRoute = _interopRequireDefault(require(\"./routes/productRoute.js\"));\nvar _categoryRoute = _interopRequireDefault(require(\"./routes/categoryRoute.js\"));\nvar _cartRoute = _interopRequireDefault(require(\"./routes/cartRoute.js\"));\nvar _orderRoute = _interopRequireDefault(require(\"./routes/orderRoute.js\"));\nvar _messageRoute = _interopRequireDefault(require(\"./routes/messageRoute.js\"));\nvar _socialRoute = _interopRequireDefault(require(\"./routes/socialRoute.js\"));\nvar _groupRoute = _interopRequireDefault(require(\"./routes/groupRoute.js\"));\nvar _commentRoute = _interopRequireDefault(require(\"./routes/commentRoute.js\"));\nvar _imageRoute = _interopRequireDefault(require(\"./routes/imageRoute.js\"));\nvar _adminRoute = _interopRequireDefault(require(\"./routes/adminRoute.js\"));\nvar _invitationRoute = _interopRequireDefault(require(\"./routes/invitationRoute.js\"));\nvar _catalogRoute = _interopRequireDefault(require(\"./routes/catalogRoute.js\"));\nrequire(\"./models/userModel.js\");\nrequire(\"./models/productModel.js\");\nrequire(\"./models/categoryModel.js\");\nrequire(\"./models/orderModel.js\");\nrequire(\"./models/commentModel.js\");\nrequire(\"./models/messageModel.js\");\nrequire(\"./models/socialModel.js\");\nrequire(\"./models/groupModel.js\");\nrequire(\"./models/productReactionModel.js\");\nrequire(\"./models/invitationModel.js\");\nrequire(\"./models/catalogModel.js\");\nrequire(\"./models/sessionModel.js\");\nrequire(\"./models/cartModel.js\");\nvar _sessionCleanup = _interopRequireDefault(require(\"./utils/sessionCleanup.js\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n// Import routers\n\n// Import models to register them with Mongoose\n\nconst _filename = (0, _url.fileURLToPath)(import.meta.url);\nconst _dirname = _path.default.dirname(_filename);\n\n// Create Express app\nconst app = (0, _express.default)();\nconst port = process.env.PORT || 3000;\n\n// Setup all middleware\n(0, _unifiedMiddleware.setupMiddleware)(app);\n\n// Setup Swagger documentation\n(0, _swagger.setupSwaggerUI)(app);\n\n// API endpoints with versioning\napp.use(\"/api/v1/user\", _userRoute.default);\napp.use(\"/api/v1/product\", _productRoute.default);\napp.use(\"/api/v1/category\", _categoryRoute.default);\napp.use(\"/api/v1/cart\", _cartRoute.default);\napp.use(\"/api/v1/orders\", _orderRoute.default);\napp.use(\"/api/v1/message\", _messageRoute.default);\napp.use(\"/api/v1/social\", _socialRoute.default);\napp.use(\"/api/v1/group\", _groupRoute.default);\napp.use(\"/api/v1/comment\", _commentRoute.default);\napp.use(\"/api/v1/image\", _imageRoute.default);\napp.use(\"/api/v1/admin\", _adminRoute.default);\napp.use(\"/api/v1/invitation\", _invitationRoute.default);\napp.use(\"/api/v1/catalog\", _catalogRoute.default);\n\n// Health check endpoint (standardized)\napp.get('/health', async (req, res) => {\n  try {\n    const dbReadyState = _mongoose.default.connection.readyState;\n    const sessionStats = await _sessionCleanup.default.getCleanupStats();\n    const healthData = {\n      status: dbReadyState === 1 ? 'healthy' : 'degraded',\n      timestamp: new Date().toISOString(),\n      database: {\n        status: dbReadyState === 1 ? 'connected' : 'disconnected',\n        readyState: dbReadyState\n      },\n      sessions: sessionStats,\n      uptime: process.uptime(),\n      memory: process.memoryUsage()\n    };\n    (0, _apiResponse.successResponse)(res, healthData, \"Health check successful\");\n  } catch (error) {\n    (0, _apiResponse.errorResponse)(res, \"Health check failed\", error, 500);\n  }\n});\n\n// Session cleanup manual trigger (for testing)\napp.post('/admin/cleanup-sessions', async (req, res) => {\n  try {\n    const result = await _sessionCleanup.default.manualCleanup();\n    (0, _apiResponse.successResponse)(res, {\n      message: 'Manual session cleanup completed',\n      result: result\n    });\n  } catch (error) {\n    (0, _apiResponse.errorResponse)(res, \"Session cleanup failed\", error, 500);\n  }\n});\n\n// Root endpoint (standardized)\napp.get(\"/\", (req, res) => {\n  (0, _apiResponse.successResponse)(res, {\n    message: \"Zero Community Backend API\",\n    status: \"running\",\n    version: \"1.0.0\",\n    documentation: \"/api-docs\",\n    endpoints: {\n      health: \"/health\",\n      api: \"/api/v1/*\"\n    }\n  });\n});\n\n// Error handling middleware\napp.use(_errorHandler.notFoundHandler);\napp.use(_errorHandler.errorHandler);\n\n// Import session cleanup\n\n// Connect to database and start server\nconst startServer = async () => {\n  try {\n    await (0, _db.connectDB)();\n\n    // Start session cleanup job\n    _sessionCleanup.default.start();\n    app.listen(port, () => {\n      console.log(` Zero Community Backend API v1.0.0 running on http://localhost:${port}`);\n      console.log(' Health check: /health');\n      console.log(' API Documentation: /api-docs');\n      console.log(' All API endpoints now use /api/v1/ prefix');\n      console.log(' Session cleanup job started (automatic guest session cleanup)');\n    });\n  } catch (error) {\n    console.error('Failed to start server:', error);\n    process.exit(1);\n  }\n};\nstartServer();\nvar _default = exports.default = app;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyZXF1aXJlIiwiX2V4cHJlc3MiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX21vbmdvb3NlIiwiX3BhdGgiLCJfdXJsIiwiX2RiIiwiX3N3YWdnZXIiLCJfdW5pZmllZE1pZGRsZXdhcmUiLCJfZXJyb3JIYW5kbGVyIiwiX2FwaVJlc3BvbnNlIiwiX3VzZXJSb3V0ZSIsIl9wcm9kdWN0Um91dGUiLCJfY2F0ZWdvcnlSb3V0ZSIsIl9jYXJ0Um91dGUiLCJfb3JkZXJSb3V0ZSIsIl9tZXNzYWdlUm91dGUiLCJfc29jaWFsUm91dGUiLCJfZ3JvdXBSb3V0ZSIsIl9jb21tZW50Um91dGUiLCJfaW1hZ2VSb3V0ZSIsIl9hZG1pblJvdXRlIiwiX2ludml0YXRpb25Sb3V0ZSIsIl9jYXRhbG9nUm91dGUiLCJfc2Vzc2lvbkNsZWFudXAiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfX2ZpbGVuYW1lIiwiZmlsZVVSTFRvUGF0aCIsImltcG9ydCIsIm1ldGEiLCJ1cmwiLCJfX2Rpcm5hbWUiLCJwYXRoIiwiZGlybmFtZSIsImFwcCIsImV4cHJlc3MiLCJwb3J0IiwicHJvY2VzcyIsImVudiIsIlBPUlQiLCJzZXR1cE1pZGRsZXdhcmUiLCJzZXR1cFN3YWdnZXJVSSIsInVzZSIsInVzZXJSb3V0ZXIiLCJwcm9kdWN0Um91dGVyIiwiY2F0ZWdvcnlSb3V0ZXIiLCJjYXJ0Um91dGVyIiwib3JkZXJSb3V0ZXIiLCJtZXNzYWdlUm91dGVyIiwic29jaWFsUm91dGVyIiwiZ3JvdXBSb3V0ZXIiLCJjb21tZW50Um91dGVyIiwiaW1hZ2VSb3V0ZXIiLCJhZG1pblJvdXRlciIsImludml0YXRpb25Sb3V0ZXIiLCJjYXRhbG9nUm91dGVyIiwiZ2V0IiwicmVxIiwicmVzIiwiZGJSZWFkeVN0YXRlIiwibW9uZ29vc2UiLCJjb25uZWN0aW9uIiwicmVhZHlTdGF0ZSIsInNlc3Npb25TdGF0cyIsInNlc3Npb25DbGVhbnVwIiwiZ2V0Q2xlYW51cFN0YXRzIiwiaGVhbHRoRGF0YSIsInN0YXR1cyIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImRhdGFiYXNlIiwic2Vzc2lvbnMiLCJ1cHRpbWUiLCJtZW1vcnkiLCJtZW1vcnlVc2FnZSIsInN1Y2Nlc3NSZXNwb25zZSIsImVycm9yIiwiZXJyb3JSZXNwb25zZSIsInBvc3QiLCJyZXN1bHQiLCJtYW51YWxDbGVhbnVwIiwibWVzc2FnZSIsInZlcnNpb24iLCJkb2N1bWVudGF0aW9uIiwiZW5kcG9pbnRzIiwiaGVhbHRoIiwiYXBpIiwibm90Rm91bmRIYW5kbGVyIiwiZXJyb3JIYW5kbGVyIiwic3RhcnRTZXJ2ZXIiLCJjb25uZWN0REIiLCJzdGFydCIsImxpc3RlbiIsImNvbnNvbGUiLCJsb2ciLCJleGl0IiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYWhtYWQvRG9jdW1lbnRzL3Byb2plY3RzL3plcm8tcHJvamVjdC9iYWNrZW5kLyIsInNvdXJjZXMiOlsic2VydmVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBcImRvdGVudi9jb25maWdcIjtcbmltcG9ydCBleHByZXNzIGZyb20gXCJleHByZXNzXCI7XG5pbXBvcnQgbW9uZ29vc2UgZnJvbSBcIm1vbmdvb3NlXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IHsgZmlsZVVSTFRvUGF0aCB9IGZyb20gXCJ1cmxcIjtcbmltcG9ydCB7IGNvbm5lY3REQiB9IGZyb20gXCIuL2NvbmZpZy9kYi5qc1wiO1xuaW1wb3J0IHsgc2V0dXBTd2FnZ2VyVUkgfSBmcm9tIFwiLi91dGlscy9zd2FnZ2VyLmpzXCI7XG5pbXBvcnQgeyBzZXR1cE1pZGRsZXdhcmUgfSBmcm9tIFwiLi9taWRkbGV3YXJlL3VuaWZpZWRNaWRkbGV3YXJlLmpzXCI7XG5pbXBvcnQgeyBlcnJvckhhbmRsZXIsIG5vdEZvdW5kSGFuZGxlciB9IGZyb20gXCIuL21pZGRsZXdhcmUvZXJyb3JIYW5kbGVyLmpzXCI7XG5pbXBvcnQgeyBzdWNjZXNzUmVzcG9uc2UsIGVycm9yUmVzcG9uc2UgfSBmcm9tIFwiLi91dGlscy9hcGlSZXNwb25zZS5qc1wiO1xuXG4vLyBJbXBvcnQgcm91dGVyc1xuaW1wb3J0IHVzZXJSb3V0ZXIgZnJvbSBcIi4vcm91dGVzL3VzZXJSb3V0ZS5qc1wiO1xuaW1wb3J0IHByb2R1Y3RSb3V0ZXIgZnJvbSBcIi4vcm91dGVzL3Byb2R1Y3RSb3V0ZS5qc1wiO1xuaW1wb3J0IGNhdGVnb3J5Um91dGVyIGZyb20gXCIuL3JvdXRlcy9jYXRlZ29yeVJvdXRlLmpzXCI7XG5pbXBvcnQgY2FydFJvdXRlciBmcm9tIFwiLi9yb3V0ZXMvY2FydFJvdXRlLmpzXCI7XG5pbXBvcnQgb3JkZXJSb3V0ZXIgZnJvbSBcIi4vcm91dGVzL29yZGVyUm91dGUuanNcIjtcbmltcG9ydCBtZXNzYWdlUm91dGVyIGZyb20gXCIuL3JvdXRlcy9tZXNzYWdlUm91dGUuanNcIjtcbmltcG9ydCBzb2NpYWxSb3V0ZXIgZnJvbSBcIi4vcm91dGVzL3NvY2lhbFJvdXRlLmpzXCI7XG5pbXBvcnQgZ3JvdXBSb3V0ZXIgZnJvbSBcIi4vcm91dGVzL2dyb3VwUm91dGUuanNcIjtcbmltcG9ydCBjb21tZW50Um91dGVyIGZyb20gXCIuL3JvdXRlcy9jb21tZW50Um91dGUuanNcIjtcbmltcG9ydCBpbWFnZVJvdXRlciBmcm9tIFwiLi9yb3V0ZXMvaW1hZ2VSb3V0ZS5qc1wiO1xuaW1wb3J0IGFkbWluUm91dGVyIGZyb20gXCIuL3JvdXRlcy9hZG1pblJvdXRlLmpzXCI7XG5pbXBvcnQgaW52aXRhdGlvblJvdXRlciBmcm9tIFwiLi9yb3V0ZXMvaW52aXRhdGlvblJvdXRlLmpzXCI7XG5pbXBvcnQgY2F0YWxvZ1JvdXRlciBmcm9tIFwiLi9yb3V0ZXMvY2F0YWxvZ1JvdXRlLmpzXCI7XG5cbi8vIEltcG9ydCBtb2RlbHMgdG8gcmVnaXN0ZXIgdGhlbSB3aXRoIE1vbmdvb3NlXG5pbXBvcnQgXCIuL21vZGVscy91c2VyTW9kZWwuanNcIjtcbmltcG9ydCBcIi4vbW9kZWxzL3Byb2R1Y3RNb2RlbC5qc1wiO1xuaW1wb3J0IFwiLi9tb2RlbHMvY2F0ZWdvcnlNb2RlbC5qc1wiO1xuaW1wb3J0IFwiLi9tb2RlbHMvb3JkZXJNb2RlbC5qc1wiO1xuaW1wb3J0IFwiLi9tb2RlbHMvY29tbWVudE1vZGVsLmpzXCI7XG5pbXBvcnQgXCIuL21vZGVscy9tZXNzYWdlTW9kZWwuanNcIjtcbmltcG9ydCBcIi4vbW9kZWxzL3NvY2lhbE1vZGVsLmpzXCI7XG5pbXBvcnQgXCIuL21vZGVscy9ncm91cE1vZGVsLmpzXCI7XG5pbXBvcnQgXCIuL21vZGVscy9wcm9kdWN0UmVhY3Rpb25Nb2RlbC5qc1wiO1xuaW1wb3J0IFwiLi9tb2RlbHMvaW52aXRhdGlvbk1vZGVsLmpzXCI7XG5pbXBvcnQgXCIuL21vZGVscy9jYXRhbG9nTW9kZWwuanNcIjtcbmltcG9ydCBcIi4vbW9kZWxzL3Nlc3Npb25Nb2RlbC5qc1wiO1xuaW1wb3J0IFwiLi9tb2RlbHMvY2FydE1vZGVsLmpzXCI7XG5cbmNvbnN0IF9fZmlsZW5hbWUgPSBmaWxlVVJMVG9QYXRoKGltcG9ydC5tZXRhLnVybCk7XG5jb25zdCBfX2Rpcm5hbWUgPSBwYXRoLmRpcm5hbWUoX19maWxlbmFtZSk7XG5cbi8vIENyZWF0ZSBFeHByZXNzIGFwcFxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xuY29uc3QgcG9ydCA9IHByb2Nlc3MuZW52LlBPUlQgfHwgMzAwMDtcblxuLy8gU2V0dXAgYWxsIG1pZGRsZXdhcmVcbnNldHVwTWlkZGxld2FyZShhcHApO1xuXG4vLyBTZXR1cCBTd2FnZ2VyIGRvY3VtZW50YXRpb25cbnNldHVwU3dhZ2dlclVJKGFwcCk7XG5cbi8vIEFQSSBlbmRwb2ludHMgd2l0aCB2ZXJzaW9uaW5nXG5hcHAudXNlKFwiL2FwaS92MS91c2VyXCIsIHVzZXJSb3V0ZXIpO1xuYXBwLnVzZShcIi9hcGkvdjEvcHJvZHVjdFwiLCBwcm9kdWN0Um91dGVyKTtcbmFwcC51c2UoXCIvYXBpL3YxL2NhdGVnb3J5XCIsIGNhdGVnb3J5Um91dGVyKTtcbmFwcC51c2UoXCIvYXBpL3YxL2NhcnRcIiwgY2FydFJvdXRlcik7XG5hcHAudXNlKFwiL2FwaS92MS9vcmRlcnNcIiwgb3JkZXJSb3V0ZXIpO1xuYXBwLnVzZShcIi9hcGkvdjEvbWVzc2FnZVwiLCBtZXNzYWdlUm91dGVyKTtcbmFwcC51c2UoXCIvYXBpL3YxL3NvY2lhbFwiLCBzb2NpYWxSb3V0ZXIpO1xuYXBwLnVzZShcIi9hcGkvdjEvZ3JvdXBcIiwgZ3JvdXBSb3V0ZXIpO1xuYXBwLnVzZShcIi9hcGkvdjEvY29tbWVudFwiLCBjb21tZW50Um91dGVyKTtcbmFwcC51c2UoXCIvYXBpL3YxL2ltYWdlXCIsIGltYWdlUm91dGVyKTtcbmFwcC51c2UoXCIvYXBpL3YxL2FkbWluXCIsIGFkbWluUm91dGVyKTtcbmFwcC51c2UoXCIvYXBpL3YxL2ludml0YXRpb25cIiwgaW52aXRhdGlvblJvdXRlcik7XG5hcHAudXNlKFwiL2FwaS92MS9jYXRhbG9nXCIsIGNhdGFsb2dSb3V0ZXIpO1xuXG4vLyBIZWFsdGggY2hlY2sgZW5kcG9pbnQgKHN0YW5kYXJkaXplZClcbmFwcC5nZXQoJy9oZWFsdGgnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBkYlJlYWR5U3RhdGUgPSBtb25nb29zZS5jb25uZWN0aW9uLnJlYWR5U3RhdGU7XG4gICAgY29uc3Qgc2Vzc2lvblN0YXRzID0gYXdhaXQgc2Vzc2lvbkNsZWFudXAuZ2V0Q2xlYW51cFN0YXRzKCk7XG5cbiAgICBjb25zdCBoZWFsdGhEYXRhID0ge1xuICAgICAgc3RhdHVzOiBkYlJlYWR5U3RhdGUgPT09IDEgPyAnaGVhbHRoeScgOiAnZGVncmFkZWQnLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBkYXRhYmFzZToge1xuICAgICAgICBzdGF0dXM6IGRiUmVhZHlTdGF0ZSA9PT0gMSA/ICdjb25uZWN0ZWQnIDogJ2Rpc2Nvbm5lY3RlZCcsXG4gICAgICAgIHJlYWR5U3RhdGU6IGRiUmVhZHlTdGF0ZVxuICAgICAgfSxcbiAgICAgIHNlc3Npb25zOiBzZXNzaW9uU3RhdHMsXG4gICAgICB1cHRpbWU6IHByb2Nlc3MudXB0aW1lKCksXG4gICAgICBtZW1vcnk6IHByb2Nlc3MubWVtb3J5VXNhZ2UoKVxuICAgIH07XG4gICAgc3VjY2Vzc1Jlc3BvbnNlKHJlcywgaGVhbHRoRGF0YSwgXCJIZWFsdGggY2hlY2sgc3VjY2Vzc2Z1bFwiKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBlcnJvclJlc3BvbnNlKHJlcywgXCJIZWFsdGggY2hlY2sgZmFpbGVkXCIsIGVycm9yLCA1MDApO1xuICB9XG59KTtcblxuLy8gU2Vzc2lvbiBjbGVhbnVwIG1hbnVhbCB0cmlnZ2VyIChmb3IgdGVzdGluZylcbmFwcC5wb3N0KCcvYWRtaW4vY2xlYW51cC1zZXNzaW9ucycsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlc3Npb25DbGVhbnVwLm1hbnVhbENsZWFudXAoKTtcbiAgICBzdWNjZXNzUmVzcG9uc2UocmVzLCB7XG4gICAgICBtZXNzYWdlOiAnTWFudWFsIHNlc3Npb24gY2xlYW51cCBjb21wbGV0ZWQnLFxuICAgICAgcmVzdWx0OiByZXN1bHRcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBlcnJvclJlc3BvbnNlKHJlcywgXCJTZXNzaW9uIGNsZWFudXAgZmFpbGVkXCIsIGVycm9yLCA1MDApO1xuICB9XG59KTtcblxuLy8gUm9vdCBlbmRwb2ludCAoc3RhbmRhcmRpemVkKVxuYXBwLmdldChcIi9cIiwgKHJlcSwgcmVzKSA9PiB7XG4gIHN1Y2Nlc3NSZXNwb25zZShyZXMsIHtcbiAgICBtZXNzYWdlOiBcIlplcm8gQ29tbXVuaXR5IEJhY2tlbmQgQVBJXCIsXG4gICAgc3RhdHVzOiBcInJ1bm5pbmdcIixcbiAgICB2ZXJzaW9uOiBcIjEuMC4wXCIsXG4gICAgZG9jdW1lbnRhdGlvbjogXCIvYXBpLWRvY3NcIixcbiAgICBlbmRwb2ludHM6IHtcbiAgICAgIGhlYWx0aDogXCIvaGVhbHRoXCIsXG4gICAgICBhcGk6IFwiL2FwaS92MS8qXCJcbiAgICB9XG4gIH0pO1xufSk7XG5cbi8vIEVycm9yIGhhbmRsaW5nIG1pZGRsZXdhcmVcbmFwcC51c2Uobm90Rm91bmRIYW5kbGVyKTtcbmFwcC51c2UoZXJyb3JIYW5kbGVyKTtcblxuLy8gSW1wb3J0IHNlc3Npb24gY2xlYW51cFxuaW1wb3J0IHNlc3Npb25DbGVhbnVwIGZyb20gXCIuL3V0aWxzL3Nlc3Npb25DbGVhbnVwLmpzXCI7XG5cbi8vIENvbm5lY3QgdG8gZGF0YWJhc2UgYW5kIHN0YXJ0IHNlcnZlclxuY29uc3Qgc3RhcnRTZXJ2ZXIgPSBhc3luYyAoKSA9PiB7XG4gIHRyeSB7XG4gICAgYXdhaXQgY29ubmVjdERCKCk7XG5cbiAgICAvLyBTdGFydCBzZXNzaW9uIGNsZWFudXAgam9iXG4gICAgc2Vzc2lvbkNsZWFudXAuc3RhcnQoKTtcblxuICAgIGFwcC5saXN0ZW4ocG9ydCwgKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coYPCfmoAgWmVybyBDb21tdW5pdHkgQmFja2VuZCBBUEkgdjEuMC4wIHJ1bm5pbmcgb24gaHR0cDovL2xvY2FsaG9zdDoke3BvcnR9YCk7XG4gICAgICBjb25zb2xlLmxvZygn8J+TiiBIZWFsdGggY2hlY2s6IC9oZWFsdGgnKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5OWIEFQSSBEb2N1bWVudGF0aW9uOiAvYXBpLWRvY3MnKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SSIEFsbCBBUEkgZW5kcG9pbnRzIG5vdyB1c2UgL2FwaS92MS8gcHJlZml4Jyk7XG4gICAgICBjb25zb2xlLmxvZygn8J+nuSBTZXNzaW9uIGNsZWFudXAgam9iIHN0YXJ0ZWQgKGF1dG9tYXRpYyBndWVzdCBzZXNzaW9uIGNsZWFudXApJyk7XG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHN0YXJ0IHNlcnZlcjonLCBlcnJvcik7XG4gICAgcHJvY2Vzcy5leGl0KDEpO1xuICB9XG59O1xuXG5zdGFydFNlcnZlcigpO1xuXG5leHBvcnQgZGVmYXVsdCBhcHA7Il0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQUEsT0FBQTtBQUNBLElBQUFDLFFBQUEsR0FBQUMsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFHLFNBQUEsR0FBQUQsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFJLEtBQUEsR0FBQUYsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFLLElBQUEsR0FBQUwsT0FBQTtBQUNBLElBQUFNLEdBQUEsR0FBQU4sT0FBQTtBQUNBLElBQUFPLFFBQUEsR0FBQVAsT0FBQTtBQUNBLElBQUFRLGtCQUFBLEdBQUFSLE9BQUE7QUFDQSxJQUFBUyxhQUFBLEdBQUFULE9BQUE7QUFDQSxJQUFBVSxZQUFBLEdBQUFWLE9BQUE7QUFHQSxJQUFBVyxVQUFBLEdBQUFULHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBWSxhQUFBLEdBQUFWLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBYSxjQUFBLEdBQUFYLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBYyxVQUFBLEdBQUFaLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBZSxXQUFBLEdBQUFiLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBZ0IsYUFBQSxHQUFBZCxzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQWlCLFlBQUEsR0FBQWYsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFrQixXQUFBLEdBQUFoQixzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQW1CLGFBQUEsR0FBQWpCLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBb0IsV0FBQSxHQUFBbEIsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFxQixXQUFBLEdBQUFuQixzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQXNCLGdCQUFBLEdBQUFwQixzQkFBQSxDQUFBRixPQUFB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","map":{"version":3,"names":["require","_express","_interopRequireDefault","_mongoose","_path","_url","_db","_swagger","_unifiedMiddleware","_errorHandler","_apiResponse","_userRoute","_productRoute","_categoryRoute","_cartRoute","_orderRoute","_messageRoute","_socialRoute","_groupRoute","_commentRoute","_imageRoute","_adminRoute","_invitationRoute","_catalogRoute","_sessionCleanup","e","__esModule","default","__filename","fileURLToPath","import","meta","url","__dirname","path","dirname","app","express","port","process","env","PORT","setupMiddleware","setupSwaggerUI","use","userRouter","productRouter","categoryRouter","cartRouter","orderRouter","messageRouter","socialRouter","groupRouter","commentRouter","imageRouter","adminRouter","invitationRouter","catalogRouter","get","req","res","dbReadyState","mongoose","connection","readyState","sessionStats","sessionCleanup","getCleanupStats","healthData","status","timestamp","Date","toISOString","database","sessions","uptime","memory","memoryUsage","successResponse","error","errorResponse","post","result","manualCleanup","message","version","documentation","endpoints","health","api","notFoundHandler","errorHandler","startServer","connectDB","start","listen","console","log","exit","_default","exports"],"sourceRoot":"/Users/ahmad/Documents/projects/zero-project/backend/","sources":["server.js"],"sourcesContent":["import \"dotenv/config\";\nimport express from \"express\";\nimport mongoose from \"mongoose\";\nimport path from \"path\";\nimport { fileURLToPath } from \"url\";\nimport { connectDB } from \"./config/db.js\";\nimport { setupSwaggerUI } from \"./utils/swagger.js\";\nimport { setupMiddleware } from \"./middleware/unifiedMiddleware.js\";\nimport { errorHandler, notFoundHandler } from \"./middleware/errorHandler.js\";\nimport { successResponse, errorResponse } from \"./utils/apiResponse.js\";\n\n// Import routers\nimport userRouter from \"./routes/userRoute.js\";\nimport productRouter from \"./routes/productRoute.js\";\nimport categoryRouter from \"./routes/categoryRoute.js\";\nimport cartRouter from \"./routes/cartRoute.js\";\nimport orderRouter from \"./routes/orderRoute.js\";\nimport messageRouter from \"./routes/messageRoute.js\";\nimport socialRouter from \"./routes/socialRoute.js\";\nimport groupRouter from \"./routes/groupRoute.js\";\nimport commentRouter from \"./routes/commentRoute.js\";\nimport imageRouter from \"./routes/imageRoute.js\";\nimport adminRouter from \"./routes/adminRoute.js\";\nimport invitationRouter from \"./routes/invitationRoute.js\";\nimport catalogRouter from \"./routes/catalogRoute.js\";\n\n// Import models to register them with Mongoose\nimport \"./models/userModel.js\";\nimport \"./models/productModel.js\";\nimport \"./models/categoryModel.js\";\nimport \"./models/orderModel.js\";\nimport \"./models/commentModel.js\";\nimport \"./models/messageModel.js\";\nimport \"./models/socialModel.js\";\nimport \"./models/groupModel.js\";\nimport \"./models/productReactionModel.js\";\nimport \"./models/invitationModel.js\";\nimport \"./models/catalogModel.js\";\nimport \"./models/sessionModel.js\";\nimport \"./models/cartModel.js\";\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\n// Create Express app\nconst app = express();\nconst port = process.env.PORT || 3000;\n\n// Setup all middleware\nsetupMiddleware(app);\n\n// Setup Swagger documentation\nsetupSwaggerUI(app);\n\n// API endpoints with versioning\napp.use(\"/api/v1/user\", userRouter);\napp.use(\"/api/v1/product\", productRouter);\napp.use(\"/api/v1/category\", categoryRouter);\napp.use(\"/api/v1/cart\", cartRouter);\napp.use(\"/api/v1/orders\", orderRouter);\napp.use(\"/api/v1/message\", messageRouter);\napp.use(\"/api/v1/social\", socialRouter);\napp.use(\"/api/v1/group\", groupRouter);\napp.use(\"/api/v1/comment\", commentRouter);\napp.use(\"/api/v1/image\", imageRouter);\napp.use(\"/api/v1/admin\", adminRouter);\napp.use(\"/api/v1/invitation\", invitationRouter);\napp.use(\"/api/v1/catalog\", catalogRouter);\n\n// Health check endpoint (standardized)\napp.get('/health', async (req, res) => {\n  try {\n    const dbReadyState = mongoose.connection.readyState;\n    const sessionStats = await sessionCleanup.getCleanupStats();\n\n    const healthData = {\n      status: dbReadyState === 1 ? 'healthy' : 'degraded',\n      timestamp: new Date().toISOString(),\n      database: {\n        status: dbReadyState === 1 ? 'connected' : 'disconnected',\n        readyState: dbReadyState\n      },\n      sessions: sessionStats,\n      uptime: process.uptime(),\n      memory: process.memoryUsage()\n    };\n    successResponse(res, healthData, \"Health check successful\");\n  } catch (error) {\n    errorResponse(res, \"Health check failed\", error, 500);\n  }\n});\n\n// Session cleanup manual trigger (for testing)\napp.post('/admin/cleanup-sessions', async (req, res) => {\n  try {\n    const result = await sessionCleanup.manualCleanup();\n    successResponse(res, {\n      message: 'Manual session cleanup completed',\n      result: result\n    });\n  } catch (error) {\n    errorResponse(res, \"Session cleanup failed\", error, 500);\n  }\n});\n\n// Root endpoint (standardized)\napp.get(\"/\", (req, res) => {\n  successResponse(res, {\n    message: \"Zero Community Backend API\",\n    status: \"running\",\n    version: \"1.0.0\",\n    documentation: \"/api-docs\",\n    endpoints: {\n      health: \"/health\",\n      api: \"/api/v1/*\"\n    }\n  });\n});\n\n// Error handling middleware\napp.use(notFoundHandler);\napp.use(errorHandler);\n\n// Import session cleanup\nimport sessionCleanup from \"./utils/sessionCleanup.js\";\n\n// Connect to database and start server\nconst startServer = async () => {\n  try {\n    await connectDB();\n\n    // Start session cleanup job\n    sessionCleanup.start();\n\n    app.listen(port, () => {\n      console.log(` Zero Community Backend API v1.0.0 running on http://localhost:${port}`);\n      console.log(' Health check: /health');\n      console.log(' API Documentation: /api-docs');\n      console.log(' All API endpoints now use /api/v1/ prefix');\n      console.log(' Session cleanup job started (automatic guest session cleanup)');\n    });\n  } catch (error) {\n    console.error('Failed to start server:', error);\n    process.exit(1);\n  }\n};\n\nstartServer();\n\nexport default app;"],"mappings":"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","ignoreList":[]}},"mtime":1766340407652}}